<html>
	<head>
        <link rel="stylesheet" type="text/css" href="main.css">
        <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
		<!--<script src="https://d3js.org/d3.v3.min.js"></script>-->
        <script src="velocity/velocity.min.js"></script>
        <script src="velocity/velocity.ui.min.js"></script>
        <script src="gameComponents/loginClass.js"></script>
        <script src="gameComponents/spin.min.js"></script>
		<script>
            var _user = null;
            var _userAvatarSrc = "restricted/images/avatars/defaultAvatar.png";
            var blockPageLoading = false;
			$("document").ready(function (){
				//load default background
                loadBackground("gameComponents/maps/exampleMap.png");
                clearScreenToStartScreen();
                
                // lock scroll position, but retain settings for later
                var scrollPosition = [
                    self.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft,
                    self.pageYOffset || document.documentElement.scrollTop  || document.body.scrollTop
                ];
                var html = jQuery('html'); // it would make more sense to apply this to body, but IE7 won't have that
                html.data('scroll-position', scrollPosition);
                html.data('previous-overflow', html.css('overflow'));
                html.css('overflow', 'hidden');
                window.scrollTo(scrollPosition[0], scrollPosition[1]);
                

			});
            /**
             * Gets the cookie
             * @author Ignacy Debicki
             * @param   {string} cname Name of cookie
             * @returns {string} Cookie content
             */
            function getCookie(cname) {
                var name = cname + "=";
                var ca = document.cookie.split(';');
                for(var i=0; i<ca.length; i++) {
                    var c = ca[i];
                    while (c.charAt(0)==' ') c = c.substring(1);
                    if (c.indexOf(name) == 0) return c.substring(name.length,c.length);
                }
                return "";
            }
			/**
			 * Sets the background for the game
			 * @author Ignacy Debicki
			 * @param {string} image URL to image file
			 */
			function loadBackground(image) {
                $("#gameDiv").css("background-image","url(" + image + ")");
			}
            /**
             * Removes all content from game screen and resets the start screen
             * @author Ignacy Debicki
             */
            function clearScreenToStartScreen(){
                //clear screen
                $("#gameDiv").velocity("slideUp",500,function(){
                    showStartScreen()
                    $(this).slideDown(100);
                }); 
            }
            /**
             * Empties the game area and shows the startGameScreen
             * @author Ignacy Debicki
             */
            function showStartScreen(){
                var screen = $("#gameDiv");
                screen.empty();
                loadElement("gameComponents/startGameScreen.html","startGameScreen");
            }
            /**
             * Loads the resource into the document
             * @author Ignacy Debicki
             * @param {string}   element  URL to the element to load
             * @param {string}   id       Identifier for the div into which the resource will be loaded
             * @param {function} callback Function to be called once the element is loaded
             */
            function loadElement(element,id,callback){
                if (blockPageLoading == false){
                    blockPageLoading = true;
                    var screen = $("#gameDiv");
                    var newDiv = $('<div id="' + id +'"></div>');
                    screen.append(newDiv);
                    var ls = new loadingScreen("#"+id);
                    
                    $.get(element, function(data) {
                        $("#" + id).append(data);
                        ls.hideLoadingScreen();
                        if (callback){
                            callback();
                        }
                    });
                    blockPageLoading = false;
                }
                
                // $("id").length - could add to queue for specific instances
            }
            /**
             * Removes the element from the document
             * @author Ignacy Debicki
             * @param {string} id Id of element to remove
             */
            function removeElement(id){
                $("#" + id).remove();
            }
            /**
             * Locks the buttons assosciated with the identifier
             * @author Ignacy Debicki
             * @param {string} id Identifier of buttons to lock. Can be a class identifier
             */
            function lockButtons(id){
                $(id).attr("disabled", "disabled");
            }
            /**
             * Unlocks the buttons assosciated with the identifier
             * @author Ignacy Debicki
             * @param {string} id Identifier of buttons to unlock. Can be a class identifier
             */
            function unlockButtons(id){
                $(id).removeAttr("disabled");
            }
            /**
             * Logs the connection error to the console
             * @author Ignacy Debicki
             * @param {object} jqXHR       jqXHR (jQuery XMLHttpRequest)
             * @param {string} textStatus  Status of the connection
             * @param {string} errorThrown HTTP error
             */
            function logError(jqXHR,textStatus,errorThrown){
                console.log(jqXHR);
                console.log(textStatus);
                console.log(errorThrown);
            }
            /**
             * Adds a loading screen to an element
             * @author Ignacy Debicki
             * @param {string} element CSS identifier of element
             */
            function loadingScreen(element){
                var overlay = $('<div class="loadingOverlay">');
                var loadingImage = new Spinner().spin();
                overlay.append(loadingImage.el);
                this.overlay=overlay;
                this.spinner = loadingImage;
                this.mainElement
                $(element).append(overlay);
            }
            
            loadingScreen.prototype={
                /**
                 * Removes the loading screen of an element
                 * @author Ignacy Debicki
                 */
                hideLoadingScreen: function(){
                    this.spinner.stop();
                    this.overlay.remove();
                }
            }
            
            
            /**
             * Returns the number of keys in an object
             * @author Ignacy Debicki
             * @param   {object} obj Object to check the size of
             * @returns {number} No of keys in object
             */
            Object.size = function(obj) {
                var size = 0, key;
                for (key in obj) {
                    if (obj.hasOwnProperty(key)) size++;
                }
                return size;
            };

            
            /**
             * Generates a new ScrollList element
             * @author Ignacy Debicki
             * @param {object}   mainElement           The div element into which the list should be put
             * @param {function} newElementConstructor Function to be called which will return a reference to an element of a list to be inserted. Accepts data argument
             * @param {function} onElementPress        Fucntion to be called when a list element is pressed
             * @param {function} onScroll              Function to be called when list is scrolled
             */
            function ScrollList(mainElement,newElementConstructor,onElementPress,onScroll){
                this.primeElement=mainElement;
                this.constructor=newElementConstructor;
                this.onElementPress=onElementPress;
                this.onScroll=onScroll;
                if (this.onScroll){
                    $(this.primeElement).scroll(this.scroll);
                }
            }
            ScrollList.prototype = {
                /**
                 * Adds element to the list
                 * @author Ignacy Debicki
                 * @param {object} data Dictionary containing values to be passed into the newElementConstructor
                 */
                addElement: function(data){
                    var element = this.constructor(data);
                    if (this.onElementPress){
                        element.click(this.onElementPress);
                    }
                    $(this.primeElement).append(element);
                },
                /**
                 * Removes element from list
                 * @author Ignacy Debicki
                 * @param {string} id ID of the object to be removed
                 */
                removeElement: function(id){
                    $(this.primeElement).children("#"+id).remove();
                },
                /**
                 * Clear the list with animation of retracting (200ms)
                 * @author Ignacy Debicki
                 * @param {function} callback Function to be performed upon completion
                 */
                clearList: function(callback){
                    $(this.primeElement).velocity({
                        scrollTop:0
                    },200,"swing",function(e){
                        $(this).velocity("slideUp",200,function(){
                            $(this).empty();
                            $(this).velocity("slideDown",200);
                            if(callback){callback();}
                        });
                    });
                },
                /**
                 * Clears the list without animation
                 * @author Ignacy Debicki
                 * @param {function} callback Function to be performed upon completion
                 */
                quickClearList: function(callback){
                    $(this.primeElement).empty();
                    if (callback){ callback(); }
                },
                /**
                 * Adds an array of elements to the list
                 * @author Ignacy Debicki
                 * @param {Array} dataArray Array containing data objects to be added via the addElement function
                 */
                addElements:function(dataArray){
                    for (var i = 0;i<dataArray.length;i++){
                        this.addElement(dataArray[i]);
                    }
                }
            };
		</script>
	</head>
	<body>
		<!-- title bar with navigation
        <div id='headerMain'>
		  <h1>Title</h1>
		</div>
		<div id='navigationBar'>
			<nav>
				<ul>
					<li><a href="">Home</a></li>
					<li><a href="">Stuff</a></li>
					<li><a href="">More stuff</a></li>
					<li><a href="">Contact us</a></li>
					
				</ul>
				<div id="socialIcons">
					<img id="twitterImg" src=images/test.png height = 20px />
				</div>
			</nav>

		</div>
        -->
        <div id="coverDiv"></div>
        <div id="coverDiv2"></div>
        <div id="coverDiv3"></div>
        <div id="coverDiv4"></div>
        <div id='gameDiv'></div>
	</body>
</html>